import{a as te}from"./chunk-XJATAMEX.mjs";import*as y from"@radix-ui/react-dialog";import*as t from"react";var ue='[cmdk-list-sizer=""]',H='[cmdk-group=""]',q='[cmdk-group-items=""]',de='[cmdk-group-heading=""]',U='[cmdk-item=""]',ne=`${U}:not([aria-disabled="true"])`,z="cmdk-item-select",S="data-value",fe=(r,s)=>te(r,s),re=t.createContext(void 0),O=()=>t.useContext(re),oe=t.createContext(void 0),B=()=>t.useContext(oe),ae=t.createContext(void 0),se=t.forwardRef((r,s)=>{let n=t.useRef(null),o=M(()=>{var e;return{search:"",value:r.value??((e=r.defaultValue)==null?void 0:e.toLowerCase())??"",filtered:{count:0,items:new Map,groups:new Set}}}),l=M(()=>new Set),d=M(()=>new Map),f=M(()=>new Map),v=M(()=>new Set),u=ce(r),{label:h,children:m,value:R,onValueChange:T,filter:D,shouldFilter:C,...I}=r,W=t.useId(),G=t.useId(),V=t.useId(),g=ye();w(()=>{if(R!==void 0){let e=R.trim().toLowerCase();o.current.value=e,g(6,Q),b.emit()}},[R]);let b=t.useMemo(()=>({subscribe:e=>(v.current.add(e),()=>v.current.delete(e)),snapshot:()=>o.current,setState:(e,i,a)=>{var c,p,E;if(!Object.is(o.current[e],i)){if(o.current[e]=i,e==="search")N(),F(),g(1,K);else if(e==="value")if(((c=u.current)==null?void 0:c.value)!==void 0){let x=i??"";(E=(p=u.current).onValueChange)==null||E.call(p,x);return}else a||g(5,Q);b.emit()}},emit:()=>{v.current.forEach(e=>e())}}),[]),_=t.useMemo(()=>({value:(e,i)=>{i!==f.current.get(e)&&(f.current.set(e,i),o.current.filtered.items.set(e,J(i)),g(2,()=>{F(),b.emit()}))},item:(e,i)=>(l.current.add(e),i&&(d.current.has(i)?d.current.get(i).add(e):d.current.set(i,new Set([e]))),g(3,()=>{N(),F(),o.current.value||K(),b.emit()}),()=>{f.current.delete(e),l.current.delete(e),o.current.filtered.items.delete(e);let a=P();g(4,()=>{N(),(a==null?void 0:a.getAttribute("id"))===e&&K(),b.emit()})}),group:e=>(d.current.has(e)||d.current.set(e,new Set),()=>{f.current.delete(e),d.current.delete(e)}),filter:()=>u.current.shouldFilter,label:h||r["aria-label"],commandRef:n,listId:W,inputId:V,labelId:G}),[]);function J(e){var a;let i=((a=u.current)==null?void 0:a.filter)??fe;return e?i(e,o.current.search):0}function F(){if(!n.current||!o.current.search||u.current.shouldFilter===!1)return;let e=o.current.filtered.items,i=[];o.current.filtered.groups.forEach(c=>{let p=d.current.get(c),E=0;p.forEach(x=>{let le=e.get(x);E=Math.max(le,E)}),i.push([c,E])});let a=n.current.querySelector(ue);k().sort((c,p)=>{let E=c.getAttribute(S),x=p.getAttribute(S);return(e.get(x)??0)-(e.get(E)??0)}).forEach(c=>{let p=c.closest(q);p?p.appendChild(c.parentElement===p?c:c.closest(`${q} > *`)):a.appendChild(c.parentElement===a?c:c.closest(`${q} > *`))}),i.sort((c,p)=>p[1]-c[1]).forEach(c=>{let p=n.current.querySelector(`${H}[${S}="${c[0]}"]`);p==null||p.parentElement.appendChild(p)})}function K(){let e=k().find(a=>!a.ariaDisabled),i=e==null?void 0:e.getAttribute(S);b.setState("value",i||void 0)}function N(){if(!o.current.search||u.current.shouldFilter===!1){o.current.filtered.count=l.current.size;return}o.current.filtered.groups=new Set;let e=0;for(let i of l.current){let a=f.current.get(i),c=J(a);o.current.filtered.items.set(i,c),c>0&&e++}for(let[i,a]of d.current)for(let c of a)if(o.current.filtered.items.get(c)>0){o.current.filtered.groups.add(i);break}o.current.filtered.count=e}function Q(){var i,a,c;let e=P();e&&(((i=e.parentElement)==null?void 0:i.firstChild)===e&&((c=(a=e.closest(H))==null?void 0:a.querySelector(de))==null||c.scrollIntoView({block:"nearest"})),e.scrollIntoView({block:"nearest"}))}function P(){var e;return(e=n.current)==null?void 0:e.querySelector(`${U}[aria-selected="true"]`)}function k(){return Array.from(n.current.querySelectorAll(ne))}function j(e){let a=k()[e];a&&b.setState("value",a.getAttribute(S))}function $(e){var E;let i=P(),a=k(),c=a.findIndex(x=>x===i),p=a[c+e];(E=u.current)!=null&&E.loop&&(p=c+e<0?a[a.length-1]:c+e===a.length?a[0]:a[c+e]),p&&b.setState("value",p.getAttribute(S))}function X(e){let i=P(),a=i==null?void 0:i.closest(H),c;for(;a&&!c;)a=e>0?Se(a,H):Ce(a,H),c=a==null?void 0:a.querySelector(ne);c?b.setState("value",c.getAttribute(S)):$(e)}let Y=()=>j(k().length-1),Z=e=>{e.preventDefault(),e.metaKey?Y():e.altKey?X(1):$(1)},ee=e=>{e.preventDefault(),e.metaKey?j(0):e.altKey?X(-1):$(-1)};return t.createElement("div",{ref:A([n,s]),...I,"cmdk-root":"",onKeyDown:e=>{var i;if((i=I.onKeyDown)==null||i.call(I,e),!e.defaultPrevented)switch(e.key){case"n":case"j":{e.ctrlKey&&Z(e);break}case"ArrowDown":{Z(e);break}case"p":case"k":{e.ctrlKey&&ee(e);break}case"ArrowUp":{ee(e);break}case"Home":{e.preventDefault(),j(0);break}case"End":{e.preventDefault(),Y();break}case"Enter":{e.preventDefault();let a=P();if(a){let c=new Event(z);a.dispatchEvent(c)}}}}},t.createElement("label",{"cmdk-label":"",htmlFor:_.inputId,id:_.labelId,style:xe},h),t.createElement(oe.Provider,{value:b},t.createElement(re.Provider,{value:_},m)))}),me=t.forwardRef((r,s)=>{var V;let n=t.useId(),o=t.useRef(null),l=t.useContext(ae),d=O(),f=ce(r),v=((V=f.current)==null?void 0:V.forceMount)??(l==null?void 0:l.forceMount);w(()=>d.item(n,l==null?void 0:l.id),[]);let u=ie(n,o,[r.value,r.children,o]),h=B(),m=L(g=>g.value&&g.value===u.current),R=L(g=>v||d.filter()===!1?!0:g.search?g.filtered.items.get(n)>0:!0);t.useEffect(()=>{let g=o.current;if(!(!g||r.disabled))return g.addEventListener(z,T),()=>g.removeEventListener(z,T)},[R,r.onSelect,r.disabled]);function T(){var g,b;D(),(b=(g=f.current).onSelect)==null||b.call(g,u.current)}function D(){h.setState("value",u.current,!0)}if(!R)return null;let{disabled:C,value:I,onSelect:W,...G}=r;return t.createElement("div",{ref:A([o,s]),...G,id:n,"cmdk-item":"",role:"option","aria-disabled":C||void 0,"aria-selected":m||void 0,"data-disabled":C||void 0,"data-selected":m||void 0,onPointerMove:C?void 0:D,onClick:C?void 0:T},r.children)}),pe=t.forwardRef((r,s)=>{let{heading:n,children:o,forceMount:l,...d}=r,f=t.useId(),v=t.useRef(null),u=t.useRef(null),h=t.useId(),m=O(),R=L(C=>l||m.filter()===!1?!0:C.search?C.filtered.groups.has(f):!0);w(()=>m.group(f),[]),ie(f,v,[r.value,r.heading,u]);let T=t.useMemo(()=>({id:f,forceMount:l}),[l]),D=t.createElement(ae.Provider,{value:T},o);return t.createElement("div",{ref:A([v,s]),...d,"cmdk-group":"",role:"presentation",hidden:R?void 0:!0},n&&t.createElement("div",{ref:u,"cmdk-group-heading":"","aria-hidden":!0,id:h},n),t.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?h:void 0},D))}),ve=t.forwardRef((r,s)=>{let{alwaysRender:n,...o}=r,l=t.useRef(null),d=L(f=>!f.search);return!n&&!d?null:t.createElement("div",{ref:A([l,s]),...o,"cmdk-separator":"",role:"separator"})}),ge=t.forwardRef((r,s)=>{let{onValueChange:n,...o}=r,l=r.value!=null,d=B(),f=L(m=>m.search),v=L(m=>m.value),u=O(),h=t.useMemo(()=>{var R;let m=(R=u.commandRef.current)==null?void 0:R.querySelector(`${U}[${S}="${v}"]`);return m==null?void 0:m.getAttribute("id")},[v,u.commandRef]);return t.useEffect(()=>{r.value!=null&&d.setState("search",r.value)},[r.value]),t.createElement("input",{ref:s,...o,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":u.listId,"aria-labelledby":u.labelId,"aria-activedescendant":h,id:u.inputId,type:"text",value:l?r.value:f,onChange:m=>{l||d.setState("search",m.target.value),n==null||n(m.target.value)}})}),Re=t.forwardRef((r,s)=>{let{children:n,...o}=r,l=t.useRef(null),d=t.useRef(null),f=O();return t.useEffect(()=>{if(d.current&&l.current){let v=d.current,u=l.current,h,m=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let R=v.offsetHeight;u.style.setProperty("--cmdk-list-height",R.toFixed(1)+"px")})});return m.observe(v),()=>{cancelAnimationFrame(h),m.unobserve(v)}}},[]),t.createElement("div",{ref:A([l,s]),...o,"cmdk-list":"",role:"listbox","aria-label":"Suggestions",id:f.listId,"aria-labelledby":f.inputId},t.createElement("div",{ref:d,"cmdk-list-sizer":""},n))}),be=t.forwardRef((r,s)=>{let{open:n,onOpenChange:o,overlayClassName:l,contentClassName:d,container:f,...v}=r;return t.createElement(y.Root,{open:n,onOpenChange:o},t.createElement(y.Portal,{container:f},t.createElement(y.Overlay,{"cmdk-overlay":"",className:l}),t.createElement(y.Content,{"aria-label":r.label,"cmdk-dialog":"",className:d},t.createElement(se,{ref:s,...v}))))}),he=t.forwardRef((r,s)=>{let n=t.useRef(!0),o=L(l=>l.filtered.count===0);return t.useEffect(()=>{n.current=!1},[]),n.current||!o?null:t.createElement("div",{ref:s,...r,"cmdk-empty":"",role:"presentation"})}),Ee=t.forwardRef((r,s)=>{let{progress:n,children:o,...l}=r;return t.createElement("div",{ref:s,...l,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":"Loading..."},t.createElement("div",{"aria-hidden":!0},o))}),Te=Object.assign(se,{List:Re,Item:me,Input:ge,Group:pe,Separator:ve,Dialog:be,Empty:he,Loading:Ee});function Se(r,s){let n=r.nextElementSibling;for(;n;){if(n.matches(s))return n;n=n.nextElementSibling}}function Ce(r,s){let n=r.previousElementSibling;for(;n;){if(n.matches(s))return n;n=n.previousElementSibling}}function ce(r){let s=t.useRef(r);return w(()=>{s.current=r}),s}var w=typeof window>"u"?t.useEffect:t.useLayoutEffect;function M(r){let s=t.useRef();return s.current===void 0&&(s.current=r()),s}function A(r){return s=>{r.forEach(n=>{typeof n=="function"?n(s):n!=null&&(n.current=s)})}}function L(r){let s=B(),n=()=>r(s.snapshot());return t.useSyncExternalStore(s.subscribe,n,n)}function ie(r,s,n){let o=t.useRef(),l=O();return w(()=>{var f;let d=(()=>{var v;for(let u of n){if(typeof u=="string")return u.trim().toLowerCase();if(typeof u=="object"&&"current"in u&&u.current)return(v=u.current.textContent)==null?void 0:v.trim().toLowerCase()}})();l.value(r,d),(f=s.current)==null||f.setAttribute(S,d),o.current=d}),o}var ye=()=>{let[r,s]=t.useState(),n=M(()=>new Map);return w(()=>{n.current.forEach(o=>o()),n.current=new Map},[r]),(o,l)=>{n.current.set(o,l),s({})}},xe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};export{Te as Command,be as CommandDialog,he as CommandEmpty,pe as CommandGroup,ge as CommandInput,me as CommandItem,Re as CommandList,Ee as CommandLoading,se as CommandRoot,ve as CommandSeparator,L as useCommandState};
